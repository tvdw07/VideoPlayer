{% extends "base.html" %}
{% block content %}

<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
    <h4 class="mb-0">ğŸ“ {{ current or "media" }}</h4>

    <form class="d-flex gap-2" method="get" action="{{ url_for('browse.browse', rel_path=current) }}">
        <input class="form-control form-control-sm" type="search" name="q" value="{{ search_query }}"
               placeholder="Suche nach Titel oder Datei" aria-label="Suche">
        {% if search_query %}
        <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('browse.browse', rel_path=current) }}">Reset</a>
        {% endif %}
        <button class="btn btn-sm btn-outline-info" type="submit">Suche</button>
    </form>
</div>

{% if search_query %}
<small class="text-secondary d-block mb-2">
    {{ total_items }} Treffer fuer "{{ search_query }}"
</small>
{% endif %}

<ul class="list-group">

    {% if current %}
    <li class="list-group-item">
        <a href="{{ url_for('browse.browse', rel_path=parent, q=search_query or None) }}">â† ZurÃ¼ck</a>
    </li>
    {% endif %}

    {% if items %}
    {% for item in items %}
    <li class="list-group-item d-flex justify-content-between align-items-center">

        <div>
            {% if item.is_dir %}
            <span class="item-dir">ğŸ“</span>
            <a href="{{ url_for('browse.browse', rel_path=item.path, q=search_query or None) }}" class="item-dir">{{
                item.name }}</a>

            {% elif item.is_video %}
            <span class="item-video">â–¶</span>
            <a href="{{ url_for('watch.watch', rel_path=item.path) }}" class="item-video">{{ item.name }}</a>

            {% else %}
            <span class="item-file">ğŸ“„ {{ item.name }}</span>
            {% endif %}
        </div>

        {% if item.is_video and item.form %}
        <form method="post"
              action="{{ url_for('browse.delete_video') }}"
              data-confirm="Video wirklich lÃ¶schen?">
            {{ item.form.hidden_tag() }}
            {{ item.form.video_path }}
            <button type="submit" class="btn btn-sm btn-outline-danger">
                LÃ¶schen
            </button>
        </form>

        {% endif %}

    </li>
    {% endfor %}
    {% else %}
    <li class="list-group-item text-secondary">
        Keine Treffer gefunden.
    </li>
    {% endif %}
</ul>

{% if pagination and pagination.pages > 1 %}
<div class="d-flex justify-content-between align-items-center mt-3">
    <small class="text-secondary">
        Seite {{ pagination.page }} / {{ pagination.pages }}
    </small>

    <ul class="pagination pagination-sm mb-0">
        <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
            <a class="page-link"
               href="{{ url_for('browse.browse', rel_path=current, page=pagination.prev_page, q=search_query or None) }}">â†</a>
        </li>

        <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
            <a class="page-link"
               href="{{ url_for('browse.browse', rel_path=current, page=pagination.next_page, q=search_query or None) }}">â†’</a>
        </li>
    </ul>
</div>
{% endif %}

{% endblock %}
